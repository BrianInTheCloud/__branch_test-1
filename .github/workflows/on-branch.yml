on:
  create # does not support filtering by type (branch), must do later

jobs:
  create-branch:
    if: github.ref_type == 'branch' # create can be branches or tags; we want only branches
    runs-on: ubuntu-latest

    steps:

    # - name: Check out everything from main
    #   uses: actions/checkout@v4
    #   with:
    #     fetch-depth: 0
    #     path: source

    - name: Dump GitHub context
      run: |
        git clone --bare https://github.com/${{ github.repository_owner }}/${{ github.event.repository.name }}.git
        cd ${{ github.event.repository.name }}
        git push --mirror https://github.com/${{ github.repository_owner }}/__branch_${{ github.ref_name }}.git
